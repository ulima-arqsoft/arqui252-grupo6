> [9. Metodolog√≠a de Dise√±o de Arquitectura - Aplicaci√≥n de ADD](../../9.md) ‚Ä∫ [9.2. Iteraci√≥n 1: Definir la estructura general del sistema](../9.2.md) ‚Ä∫ [9.2.3. Conceptos de dise√±o](9.2.3.md)

# 9.2.3. Conceptos de dise√±o

## Conceptos de Dise√±o

Esta secci√≥n documenta los conceptos, patrones y estilos arquitect√≥nicos seleccionados para estructurar el sistema NEXUS.

---

### 1. Estilo Arquitect√≥nico Principal: Microservicios

#### Descripci√≥n

La arquitectura de microservicios descompone la aplicaci√≥n en servicios peque√±os, independientes y desplegables de forma aut√≥noma, cada uno ejecut√°ndose en su propio proceso y comunic√°ndose mediante mecanismos ligeros (HTTP/REST, eventos).

#### Justificaci√≥n para NEXUS

| Beneficio | Aplicaci√≥n en NEXUS |
|---|---|
| **Modularidad** | Alineaci√≥n directa con los 5 m√≥dulos del equipo (CON01) |
| **Escalabilidad independiente** | El m√≥dulo de Colaboraci√≥n puede escalar sin afectar Pagos |
| **Tecnolog√≠a heterog√©nea** | Permite usar PostgreSQL, MongoDB, Elasticsearch seg√∫n necesidad |
| **Despliegue independiente** | Cada integrante puede desplegar su m√≥dulo sin coordinaci√≥n compleja |
| **Resiliencia** | Fallo en B√∫squeda no afecta Chat o Pagos |

#### Desventajas Aceptadas

- Mayor complejidad operacional (mitigada con contenedores y orquestaci√≥n)
- Latencia de red entre servicios (mitigada con cach√© y comunicaci√≥n as√≠ncrona)
- Transacciones distribuidas (evitadas mediante dise√±o de bounded contexts)

---

### 2. Patr√≥n: API Gateway

#### Descripci√≥n

Un √∫nico punto de entrada que enruta las peticiones a los microservicios correspondientes, centralizando funcionalidades transversales.

#### Responsabilidades del API Gateway

![API Gateway](./diagrama/API_GATEWAY.png)

#### Implementaci√≥n en NEXUS

- **Tecnolog√≠a**: NGINX con configuraci√≥n de proxy inverso
- **Funciones**:
  - Validaci√≥n de tokens JWT (Gateway Offloading - trabajo individual Integrante 2)
  - Rate limiting por IP/usuario
  - Enrutamiento basado en path (`/api/ideas/*` ‚Üí Microservicio Ideas)
  - Terminaci√≥n SSL/TLS
  - Compresi√≥n de respuestas
  - CORS

#### Beneficios

- Simplifica clientes (un solo endpoint)
- Centraliza seguridad y pol√≠ticas
- Reduce acoplamiento cliente-servicios

---

### 3. Patr√≥n: Event-Driven Architecture (EDA)

#### Descripci√≥n

Los microservicios se comunican mediante eventos as√≠ncronos publicados en un message broker, permitiendo desacoplamiento temporal y l√≥gico.

#### Arquitectura de Eventos en NEXUS

![Arquitectura de Eventos](./diagrama/EVENTOS.png)

#### Eventos Principales

| Evento | Productor | Consumidores | Prop√≥sito |
|---|---|---|---|
| `IdeaCreated` | Ideas | B√∫squeda, Colaboraci√≥n | Indexar idea, crear sala de chat |
| `IdeaUpdated` | Ideas | B√∫squeda | Reindexar idea |
| `MessageSent` | Colaboraci√≥n | Notificaciones | Enviar push notification |
| `PaymentCompleted` | Pagos | Ideas, Notificaciones | Actualizar estado, notificar usuario |
| `UserRegistered` | Perfil | Notificaciones | Enviar email de bienvenida |

#### Beneficios

- **Desacoplamiento**: Servicios no necesitan conocerse entre s√≠
- **Escalabilidad**: Procesamiento as√≠ncrono de eventos
- **Resiliencia**: Eventos persisten en cola si consumidor est√° ca√≠do
- **Extensibilidad**: Nuevos consumidores sin modificar productores

---

### 4. Estrategia: Persistencia Poliglota

#### Descripci√≥n

Cada microservicio selecciona la tecnolog√≠a de base de datos m√°s adecuada a sus necesidades de datos.

#### Mapeo de Persistencia

![Mapeo de Persistencia](./diagrama/MAPEO_PERSISTENCIA.png)

#### Justificaci√≥n por Servicio

| Microservicio | BD Principal | Raz√≥n |
|---|---|---|
| **Perfil** | PostgreSQL | Datos estructurados, relaciones (usuarios-roles-habilidades), ACID |
| **Ideas** | MongoDB | Esquema flexible (ideas evolucionan), documentos anidados (comentarios) |
| **B√∫squeda** | Elasticsearch | B√∫squeda full-text, filtros complejos, ranking por relevancia |
| **Colaboraci√≥n** | PostgreSQL + Redis | SQL: mensajes persistentes; Redis: pub/sub, presencia en l√≠nea |
| **Pagos** | PostgreSQL | Transacciones ACID cr√≠ticas, auditor√≠a, integridad financiera |

---

### 5. Patr√≥n: Backend for Frontend (BFF)

#### Descripci√≥n

Aunque no se implementa completamente en esta iteraci√≥n, se considera para futuras optimizaciones: APIs espec√≠ficas para web vs m√≥vil.

#### Aplicaci√≥n Futura

- **BFF Web**: Respuestas m√°s ricas, paginaci√≥n compleja
- **BFF M√≥vil**: Respuestas optimizadas, menor payload, agregaci√≥n de datos

---

### 6. Estrategia de Comunicaci√≥n

#### Comunicaci√≥n Sincr√≥nica (REST)

- **Uso**: Operaciones CRUD, consultas inmediatas
- **Protocolo**: HTTP/HTTPS con JSON
- **Patr√≥n**: Request-Response
- **Ejemplo**: Cliente solicita lista de ideas ‚Üí API Gateway ‚Üí Microservicio Ideas

#### Comunicaci√≥n Asincr√≥nica (Eventos)

- **Uso**: Notificaciones, sincronizaci√≥n entre servicios
- **Protocolo**: AMQP (RabbitMQ)
- **Patr√≥n**: Publish-Subscribe
- **Ejemplo**: Idea creada ‚Üí Evento ‚Üí B√∫squeda indexa, Colaboraci√≥n crea sala

#### Comunicaci√≥n en Tiempo Real (WebSocket)

- **Uso**: Chat, notificaciones push, indicadores de presencia
- **Protocolo**: WebSocket (Socket.IO)
- **Patr√≥n**: Bidireccional persistente
- **Ejemplo**: Usuario env√≠a mensaje ‚Üí WebSocket ‚Üí Todos en sala reciben

---

### 7. Estrategia de Despliegue: Contenedores

#### Descripci√≥n

Cada microservicio se empaqueta en un contenedor Docker, permitiendo portabilidad y escalabilidad.

#### Beneficios

- **Consistencia**: Mismo entorno en desarrollo, staging, producci√≥n
- **Aislamiento**: Cada servicio con sus dependencias
- **Escalabilidad**: Orquestaci√≥n con Kubernetes o Docker Swarm
- **CI/CD**: Pipelines automatizados por servicio

---

### Resumen de Decisiones

| Concepto | Selecci√≥n | Alternativa Descartada | Raz√≥n |
|---|---|---|---|
| Estilo arquitect√≥nico | Microservicios | Monolito modular | Equipos independientes, escalabilidad |
| API Gateway | NGINX | Kong, AWS API Gateway | Experiencia del equipo, control total |
| Message Broker | RabbitMQ | Kafka, AWS SQS | Simplicidad, suficiente para escala inicial |
| Persistencia | Poliglota | Una sola BD | Optimizaci√≥n por tipo de datos |
| Comunicaci√≥n | REST + Eventos + WebSocket | Solo REST | Requisitos de tiempo real y desacoplamiento |

---

[‚¨ÖÔ∏è Anterior](../9.2.2/9.2.2.md) | [üè† Home](../../../README.md) | [Siguiente ‚û°Ô∏è](../9.2.4/9.2.4.md)