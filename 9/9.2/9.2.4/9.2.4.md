> [9. Metodolog√≠a de Dise√±o de Arquitectura - Aplicaci√≥n de ADD](../../9.md) ‚Ä∫ [9.2. Iteraci√≥n 1: Definir la estructura general del sistema](../9.2.md) ‚Ä∫ [9.2.4. Elementos instanciados](9.2.4.md)

# 9.2.4. Elementos instanciados

## Elementos Instanciados

Esta secci√≥n documenta los elementos arquitect√≥nicos concretos que resultan de aplicar los conceptos de dise√±o definidos en la secci√≥n anterior.

---

### Vista General de Elementos Instanciados

![Vista General de Elementos Instanciados](./diagrama/ELEMENTOS_INSTANCIADOS.png)

---

### 1. Aplicaciones Cliente

#### 1.1. Aplicaci√≥n Web

| Atributo | Valor |
|---|---|
| **Nombre** | NEXUS Web App |
| **Tecnolog√≠a** | React 18 + TypeScript + Vite |
| **Responsabilidad** | Interfaz de usuario web responsive |
| **Comunicaci√≥n** | HTTP REST (API Gateway), WebSocket (Chat) |
| **Gesti√≥n de Estado** | Redux Toolkit |
| **Enrutamiento** | React Router v6 |
| **Puerto** | 3000 (desarrollo), 80/443 (producci√≥n) |

**Pantallas Principales**:
- B√∫squeda de Ideas
- Publicaci√≥n de Ideas
- Perfil de Usuario
- Proyectos Activos
- Chat de Colaboraci√≥n
- Gesti√≥n de Pagos

#### 1.2. Aplicaci√≥n M√≥vil

| Atributo | Valor |
|---|---|
| **Nombre** | NEXUS Mobile App |
| **Tecnolog√≠a** | React Native + Expo SDK 49 |
| **Plataformas** | iOS 13+, Android 8+ |
| **Responsabilidad** | Interfaz m√≥vil nativa |
| **Comunicaci√≥n** | HTTP REST, WebSocket |
| **Navegaci√≥n** | React Navigation v6 |
| **Notificaciones** | Expo Notifications |

---

### 2. Capa de Gateway

#### 2.1. API Gateway

| Atributo | Valor |
|---|---|
| **Nombre** | NEXUS API Gateway |
| **Tecnolog√≠a** | NGINX 1.24 |
| **Responsabilidad** | Enrutamiento, autenticaci√≥n, rate limiting |
| **Puerto** | 8080 (HTTP), 8443 (HTTPS) |
| **Configuraci√≥n** | `/etc/nginx/nginx.conf` |

**Rutas de Enrutamiento**:

| Path | Microservicio Destino | M√©todo |
|---|---|---|
| `/api/auth/*` | MS Perfil | POST, GET |
| `/api/users/*` | MS Perfil | GET, PUT, DELETE |
| `/api/ideas/*` | MS Ideas | GET, POST, PUT, DELETE |
| `/api/projects/*` | MS Ideas | GET, POST, PUT |
| `/api/search/*` | MS B√∫squeda | GET |
| `/api/chat/*` | MS Colaboraci√≥n | GET, POST |
| `/api/payments/*` | MS Pagos | POST, GET |
| `/ws/chat` | MS Colaboraci√≥n (WebSocket) | WS |

**Funcionalidades Implementadas**:
- ‚úÖ Validaci√≥n JWT mediante `auth_request` (Gateway Offloading)
- ‚úÖ Rate Limiting: 100 req/min por IP
- ‚úÖ CORS configurado para dominios permitidos
- ‚úÖ Compresi√≥n gzip
- ‚úÖ Logs de acceso y errores

---

### 3. Microservicios Backend

#### 3.1. Microservicio de Perfil

| Atributo | Valor |
|---|---|
| **Nombre** | nexus-profile-service |
| **Tecnolog√≠a** | NestJS 10 + TypeScript |
| **Puerto** | 3001 |
| **Base de Datos** | PostgreSQL (BD: nexus_profile) |
| **Responsabilidad** | Autenticaci√≥n, gesti√≥n de usuarios, roles |

**Endpoints Principales**:
- `POST /auth/register` - Registro de usuario
- `POST /auth/login` - Inicio de sesi√≥n (retorna JWT)
- `POST /auth/logout` - Cierre de sesi√≥n
- `GET /users/:id` - Obtener perfil
- `PUT /users/:id` - Actualizar perfil
- `GET /users/:id/skills` - Obtener habilidades

**Eventos Publicados**:
- `UserRegistered` ‚Üí Notificaciones (email bienvenida)
- `UserUpdated` ‚Üí Cach√© (invalidaci√≥n)

#### 3.2. Microservicio de Ideas

| Atributo | Valor |
|---|---|
| **Nombre** | nexus-ideas-service |
| **Tecnolog√≠a** | NestJS 10 + TypeScript |
| **Puerto** | 3002 |
| **Base de Datos** | MongoDB (DB: nexus_ideas) |
| **Responsabilidad** | Publicaci√≥n, gesti√≥n de ideas y proyectos |

**Endpoints Principales**:
- `POST /ideas` - Crear idea
- `GET /ideas/:id` - Obtener idea
- `PUT /ideas/:id` - Actualizar idea
- `DELETE /ideas/:id` - Eliminar idea
- `POST /ideas/:id/comments` - Comentar idea
- `POST /projects` - Convertir idea a proyecto

**Eventos Publicados**:
- `IdeaCreated` ‚Üí B√∫squeda (indexar), Colaboraci√≥n (crear sala)
- `IdeaUpdated` ‚Üí B√∫squeda (reindexar)
- `IdeaDeleted` ‚Üí B√∫squeda (eliminar √≠ndice)

#### 3.3. Microservicio de B√∫squeda

| Atributo | Valor |
|---|---|
| **Nombre** | nexus-search-service |
| **Tecnolog√≠a** | NestJS 10 + TypeScript |
| **Puerto** | 3003 |
| **Motor de B√∫squeda** | Elasticsearch 8.x |
| **Responsabilidad** | B√∫squeda full-text, filtrado de ideas |

**Endpoints Principales**:
- `GET /search?q=...&category=...&tags=...` - B√∫squeda de ideas
- `GET /search/suggestions?q=...` - Autocompletado

**Eventos Consumidos**:
- `IdeaCreated` ‚Üí Indexar en Elasticsearch
- `IdeaUpdated` ‚Üí Actualizar √≠ndice
- `IdeaDeleted` ‚Üí Eliminar del √≠ndice

#### 3.4. Microservicio de Colaboraci√≥n

| Atributo | Valor |
|---|---|
| **Nombre** | nexus-collaboration-service |
| **Tecnolog√≠a** | NestJS 10 + Socket.IO + TypeScript |
| **Puerto** | 3004 (HTTP), 3004 (WebSocket) |
| **Base de Datos** | PostgreSQL (mensajes) + Redis (pub/sub) |
| **Responsabilidad** | Chat en tiempo real, postulaciones, notificaciones |

**Endpoints Principales**:
- `GET /chat/rooms` - Listar salas
- `POST /chat/rooms` - Crear sala
- `GET /chat/rooms/:id/messages` - Historial de mensajes
- `POST /applications` - Postular a proyecto
- `PUT /applications/:id` - Aceptar/rechazar postulaci√≥n

**WebSocket Events**:
- `message:send` - Enviar mensaje
- `message:receive` - Recibir mensaje
- `user:typing` - Usuario escribiendo
- `user:online` - Usuario conectado

**Eventos Publicados**:
- `MessageSent` ‚Üí Notificaciones (push notification)
- `ApplicationSubmitted` ‚Üí Notificaciones

**Eventos Consumidos**:
- `IdeaCreated` ‚Üí Crear sala de chat autom√°ticamente

#### 3.5. Microservicio de Pagos

| Atributo | Valor |
|---|---|
| **Nombre** | nexus-payments-service |
| **Tecnolog√≠a** | NestJS 10 + TypeScript |
| **Puerto** | 3005 |
| **Base de Datos** | PostgreSQL (BD: nexus_payments) |
| **Integraci√≥n Externa** | Stripe API |
| **Responsabilidad** | Procesamiento de pagos, recompensas, escrow |

**Endpoints Principales**:
- `POST /payments/intent` - Crear intenci√≥n de pago
- `POST /payments/confirm` - Confirmar pago
- `GET /payments/:id` - Obtener estado de pago
- `POST /webhooks/stripe` - Webhook de Stripe
- `GET /balance/:userId` - Obtener balance de usuario

**Eventos Publicados**:
- `PaymentCompleted` ‚Üí Ideas (actualizar estado), Notificaciones
- `PaymentFailed` ‚Üí Notificaciones

---

### 4. Infraestructura de Soporte

#### 4.1. Message Broker

| Atributo | Valor |
|---|---|
| **Nombre** | RabbitMQ Cluster |
| **Versi√≥n** | RabbitMQ 3.12 |
| **Puerto** | 5672 (AMQP), 15672 (Management UI) |
| **Exchanges** | `nexus.events` (topic) |
| **Queues** | `search.index`, `notifications.push`, `metrics.collect` |

**Configuraci√≥n**:
- Persistencia de mensajes habilitada
- Dead Letter Queue configurada
- TTL de mensajes: 24 horas

#### 4.2. Cach√© Distribuida

| Atributo | Valor |
|---|---|
| **Nombre** | Redis Cluster |
| **Versi√≥n** | Redis 7.0 |
| **Puerto** | 6379 |
| **Uso** | Cach√© de sesiones, pub/sub para WebSocket, rate limiting |

**Estrategias de Cach√©**:
- Perfiles de usuario: TTL 1 hora
- Ideas populares: TTL 15 minutos
- Resultados de b√∫squeda: TTL 5 minutos

#### 4.3. Almacenamiento de Archivos

| Atributo | Valor |
|---|---|
| **Nombre** | AWS S3 Bucket |
| **Bucket** | `nexus-media-prod` |
| **Regi√≥n** | us-east-1 |
| **Uso** | Im√°genes de ideas, avatares, documentos adjuntos |

**Configuraci√≥n**:
- Acceso p√∫blico para im√°genes (con firma)
- Versionado habilitado
- Lifecycle policy: eliminar despu√©s de 90 d√≠as si no referenciado

---

### 5. Bases de Datos

#### 5.1. PostgreSQL

| Atributo | Valor |
|---|---|
| **Versi√≥n** | PostgreSQL 2022 |
| **Puerto** | 1433 |
| **Bases de Datos** | `nexus_profile`, `nexus_collaboration`, `nexus_payments` |

**Esquemas**:
- **nexus_profile**: Users, Roles, Skills, UserSkills
- **nexus_collaboration**: Conversations, Messages, Applications
- **nexus_payments**: Transactions, Balances, Escrow

#### 5.2. MongoDB

| Atributo | Valor |
|---|---|
| **Versi√≥n** | MongoDB 7.0 |
| **Puerto** | 27017 |
| **Base de Datos** | `nexus_ideas` |

**Colecciones**:
- `ideas`: Documentos de ideas con metadata
- `projects`: Proyectos activos
- `comments`: Comentarios anidados

#### 5.3. Elasticsearch

| Atributo | Valor |
|---|---|
| **Versi√≥n** | Elasticsearch 8.10 |
| **Puerto** | 9200 (HTTP), 9300 (Transport) |
| **√çndice** | `nexus_ideas_index` |

**Configuraci√≥n del √çndice**:
- Analizador en espa√±ol
- Campos: title (boost 2.0), description, tags, category
- Fuzzy matching habilitado

---

### Tabla Resumen de Elementos Instanciados

| Categor√≠a | Elemento | Tecnolog√≠a | Puerto | Estado |
|---|---|---|---|---|
| Cliente | Web App | React | 3000 | ‚úÖ Definido |
| Cliente | Mobile App | React Native | - | ‚úÖ Definido |
| Gateway | API Gateway | NGINX | 8080 | ‚úÖ Definido |
| Microservicio | Perfil | NestJS | 3001 | ‚úÖ Definido |
| Microservicio | Ideas | NestJS | 3002 | ‚úÖ Definido |
| Microservicio | B√∫squeda | NestJS | 3003 | ‚úÖ Definido |
| Microservicio | Colaboraci√≥n | NestJS + Socket.IO | 3004 | ‚úÖ Definido |
| Microservicio | Pagos | NestJS | 3005 | ‚úÖ Definido |
| Infraestructura | RabbitMQ | RabbitMQ | 5672 | ‚úÖ Definido |
| Infraestructura | Redis | Redis | 6379 | ‚úÖ Definido |
| Infraestructura | S3 | AWS S3 | - | ‚úÖ Definido |
| Base de Datos | PostgreSQL | PostgreSQL | 1433 | ‚úÖ Definido |
| Base de Datos | MongoDB | MongoDB | 27017 | ‚úÖ Definido |
| Base de Datos | Elasticsearch | Elasticsearch | 9200 | ‚úÖ Definido |

---


[‚¨ÖÔ∏è Anterior](../9.2.3/9.2.3.md) | [üè† Home](../../../README.md) | [Siguiente ‚û°Ô∏è](../9.2.5/9.2.5.md)