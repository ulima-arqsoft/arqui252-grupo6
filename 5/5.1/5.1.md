> [5. T√°cticas](../5.md) ‚Ä∫ [5.1. M√≥dulo 1 / Integrante 1](5.1.md)

# 5.1. M√≥dulo 1 / Integrante 1

## Escenario
| Atributo | ID Escenario | Fuente Est√≠mulo | Est√≠mulo | Artefacto | Entorno | Respuesta | Medida de Respuesta | Comentario |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| **Rendimiento** | **ESC-01** | Usuario realizando b√∫squeda | Usuario ejecuta b√∫squeda con palabra clave en base con 10k ideas | Motor de b√∫squeda del M√≥dulo de B√∫squeda de Ideas | Base de datos con 10,000 ideas indexadas | El sistema devuelve resultados ordenados por relevancia | Tiempo de respuesta p95 ‚â§ 1 seg | Garantiza experiencia fluida en b√∫squedas b√°sicas |

### T√°ctica Elegida
La t√°ctica elegida es **Introducir Concurrencia**, espec√≠ficamente mediante el uso de √≠ndices invertidos y procesamiento paralelo de consultas.

**T√≠tulo**:
- T√°ctica de Indexaci√≥n Avanzada con Elasticsearch para Optimizaci√≥n de B√∫squedas (ESC-01).

**Contexto**:
- Los usuarios de NEXUS necesitan encontrar ideas relevantes r√°pidamente mediante palabras clave (HU001). El requisito funcional **RF001** exige un tiempo de respuesta p95 ‚â§ 1s con 10k ideas. Las b√∫squedas full-text en bases de datos relacionales o b√∫squedas secuenciales son insuficientes para cumplir esta m√©trica bajo carga concurrente.

**Alternativas**:
1. **Introducir Concurrencia (√çndices Invertidos + Procesamiento Paralelo)**:
    - Utilizar Elasticsearch con √≠ndices invertidos que permiten b√∫squedas full-text en tiempo casi constante O(1) para la localizaci√≥n de t√©rminos. El motor distribuye la consulta entre m√∫ltiples shards procesados en paralelo.
    - Proporciona b√∫squedas sub-segundo incluso con millones de documentos, scoring de relevancia avanzado (BM25).
2. **Incrementar Recursos Disponibles (Escalamiento Vertical)**:
    - Aumentar CPU y RAM del servidor de base de datos para acelerar consultas secuenciales.
    - Limitado por capacidad m√°xima del hardware, no resuelve el problema algor√≠tmico de b√∫squeda full-text.

**Criterios de Elecci√≥n**:
- Cumplir con m√©trica de rendimiento p95 ‚â§ 1s bajo carga concurrente.
- Escalabilidad horizontal para crecimiento futuro.
- Calidad de resultados con scoring de relevancia.

**Decisi√≥n**:
- Se elige la t√°ctica de **Introducir Concurrencia** mediante Elasticsearch con arquitectura de sharding y r√©plicas.

**Sustento**:
- Los **√≠ndices invertidos** de Elasticsearch permiten localizar documentos que contienen t√©rminos espec√≠ficos en tiempo casi constante. El procesamiento distribuido entre shards procesa la consulta en paralelo, agregando resultados finales. Con 3 shards primarios y 2 r√©plicas, el sistema puede procesar b√∫squedas concurrentes eficientemente, garantizando el **p95 ‚â§ 1s** requerido por RF001. Esta arquitectura escala horizontalmente agregando m√°s nodos al cl√∫ster.

---

## Escenario
| Atributo | ID Escenario | Fuente Est√≠mulo | Est√≠mulo | Artefacto | Entorno | Respuesta | Medida de Respuesta | Comentario |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| **Rendimiento** | **ESC-02** | Usuario escribiendo en buscador | Usuario escribe consulta y activa autocompletado | Servicio de autocompletado del m√≥dulo | Interacci√≥n en tiempo real | El sistema muestra sugerencias relevantes sin duplicados | Tiempo de respuesta p95 ‚â§ 150 ms | Cr√≠tico para UX moderna y b√∫squeda predictiva |

### T√°ctica Elegida
La t√°ctica elegida es **Incrementar Recursos Disponibles**, espec√≠ficamente mediante el uso de cach√© distribuida (Redis) para consultas frecuentes.

**T√≠tulo**:
- Implementaci√≥n de Cach√© Distribuida para Autocompletado de Alta Velocidad (ESC-02).

**Contexto**:
- El autocompletado es una funcionalidad cr√≠tica para la experiencia de usuario (HU008). El requisito **RF005** exige p95 ‚â§ 150ms, lo cual es muy exigente. Consultar Elasticsearch directamente para cada pulsaci√≥n de tecla consume recursos y puede no cumplir la m√©trica bajo carga alta.

**Alternativas**:
1. **Incrementar Recursos Disponibles (Cach√© Distribuida - Redis)**:
    - Precomputar y almacenar en Redis las sugerencias m√°s frecuentes organizadas por prefijos (Trie structure). Las consultas de autocompletado golpean primero la cach√©.
    - Latencia sub-milisegundo desde Redis, reduce carga en Elasticsearch significativamente.
2. **Mantener M√∫ltiples Copias (R√©plicas de Elasticsearch)**:
    - Aumentar r√©plicas de Elasticsearch para distribuir carga de autocompletado.
    - Mayor costo de infraestructura, latencia sigue siendo mayor que cach√© en memoria.

**Criterios de Elecci√≥n**:
- Cumplir con m√©trica ultra-exigente p95 ‚â§ 150ms.
- Reducir carga en Elasticsearch para optimizar costos.
- Experiencia de usuario fluida sin lag perceptible.

**Decisi√≥n**:
- Se elige la t√°ctica de **Incrementar Recursos Disponibles** mediante cach√© distribuida Redis con estructura Trie para prefijos.

**Sustento**:
- Redis proporciona latencias de **< 1ms** para operaciones de lectura en memoria. Implementando una estructura Trie con los t√©rminos y prefijos m√°s frecuentes (actualizada cada 5 minutos), el 80% de las consultas de autocompletado se resuelven desde cach√©. Para consultas no cacheadas, se ejecuta contra Elasticsearch con n-grams precomputados. Esta arquitectura h√≠brida garantiza el **p95 ‚â§ 150ms** requerido por RF005, mejorando significativamente la UX.

---

## Escenario
| Atributo | ID Escenario | Fuente Est√≠mulo | Est√≠mulo | Artefacto | Entorno | Respuesta | Medida de Respuesta | Comentario |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| **Disponibilidad** | **ESC-03** | Usuario con conexi√≥n inestable | Usuario pierde conectividad durante una b√∫squeda activa | M√≥dulo de B√∫squeda de Ideas | Uso normal con conexi√≥n intermitente | El sistema mantiene cach√© local y restaura estado al reconectarse | Restauraci√≥n de estado ‚â§ 3 seg tras reconexi√≥n | Evita frustraci√≥n y p√©rdida de contexto de b√∫squeda |

### T√°ctica Elegida
La t√°ctica elegida es **Manejo de Excepciones**, espec√≠ficamente mediante estrategias de reintentos y almacenamiento local de estado.

**T√≠tulo**:
- Implementaci√≥n de Cach√© Local y Estrategia de Reintentos para Resiliencia ante Desconexiones (ESC-03).

**Contexto**:
- Los usuarios m√≥viles de NEXUS pueden experimentar conectividad intermitente (HU006). Perder el contexto de b√∫squeda (filtros aplicados, scroll position, t√©rminos ingresados) genera frustraci√≥n. El sistema debe restaurar el estado completo en ‚â§ 3 seg tras reconexi√≥n.

**Alternativas**:
1. **Manejo de Excepciones (Reintentos + Estado Local)**:
    - La aplicaci√≥n cliente almacena el estado de b√∫squeda (query, filtros, p√°gina actual) en Local Storage/IndexedDB. Al detectar reconexi√≥n, reintenta la consulta autom√°ticamente con exponential backoff.
    - Restauraci√≥n inmediata del contexto, experiencia fluida sin intervenci√≥n del usuario.
2. **Sincronizaci√≥n (Estado en Servidor)**:
    - Mantener sesi√≥n de b√∫squeda en servidor con sincronizaci√≥n peri√≥dica.
    - Mayor complejidad, requiere autenticaci√≥n persistente, mayor latencia de restauraci√≥n.

**Criterios de Elecci√≥n**:
- Velocidad de restauraci√≥n ‚â§ 3 seg tras reconexi√≥n.
- Independencia de disponibilidad del servidor durante desconexi√≥n.
- Simplicidad de implementaci√≥n en cliente m√≥vil.

**Decisi√≥n**:
- Se elige la t√°ctica de **Manejo de Excepciones** mediante almacenamiento local de estado y reintentos autom√°ticos con exponential backoff.

**Sustento**:
- Al almacenar el estado de b√∫squeda (query, filtros activos, resultados visualizados, scroll position) en **Local Storage** del navegador o **AsyncStorage** en React Native, la aplicaci√≥n puede restaurar inmediatamente la UI al detectar reconexi√≥n. La estrategia de reintentos (3 intentos con delays de 1s, 2s, 4s) permite recuperar datos actualizados del servidor mientras muestra datos cacheados. Esta arquitectura garantiza **restauraci√≥n ‚â§ 3s** y proporciona experiencia offline-first alineada con PWA best practices.

---

## Escenario
| Atributo | ID Escenario | Fuente Est√≠mulo | Est√≠mulo | Artefacto | Entorno | Respuesta | Medida de Respuesta | Comentario |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| **Seguridad** | **ESC-04** | Usuario autenticado | Usuario intenta acceder a ideas privadas/compartidas | Sistema de control de acceso del m√≥dulo | M√∫ltiples niveles de visibilidad activos | El sistema filtra resultados seg√∫n permisos del usuario | 100% de ideas respetan visibilidad configurada | Protege privacidad y confidencialidad de ideas |

### T√°ctica Elegida
La t√°ctica elegida es **Limitar el Acceso**, espec√≠ficamente mediante filtros de seguridad a nivel de consulta (Row-Level Security).

**T√≠tulo**:
- Implementaci√≥n de Filtrado de Visibilidad a Nivel de Consulta para Garantizar Seguridad (ESC-04).

**Contexto**:
- NEXUS maneja tres niveles de visibilidad: p√∫blica, privada y compartida (RF007). El requisito cr√≠tico es que **100% de ideas respeten su configuraci√≥n de visibilidad** en todo momento. Un error de seguridad podr√≠a exponer ideas confidenciales y destruir la confianza en la plataforma.

**Alternativas**:
1. **Limitar el Acceso (Filtros de Seguridad a Nivel de Consulta)**:
    - Inyectar autom√°ticamente cl√°usulas de filtrado en todas las consultas a Elasticsearch basadas en el contexto de seguridad del usuario autenticado: `(visibility:public OR owner_id:{user_id} OR shared_with:{user_id})`.
    - Garant√≠a de seguridad a nivel de datos, imposible bypassear desde cliente.
2. **Autorizar (Verificaci√≥n Post-Consulta)**:
    - Obtener todos los resultados y filtrar en capa de aplicaci√≥n.
    - Ineficiente, paginaci√≥n incorrecta, mayor latencia, riesgo de fugas si hay bug en c√≥digo de aplicaci√≥n.

**Criterios de Elecci√≥n**:
- Garant√≠a absoluta de seguridad (100% compliance).
- Performance sin degradaci√≥n significativa.
- Imposibilidad de bypass por errores en cliente.

**Decisi√≥n**:
- Se elige la t√°ctica de **Limitar el Acceso** mediante filtros de seguridad inyectados autom√°ticamente a nivel de consulta Elasticsearch.

**Sustento**:
- Implementando un **Security Context Interceptor** en el microservicio de b√∫squeda, todas las consultas a Elasticsearch incluyen autom√°ticamente las cl√°usulas de visibilidad basadas en el JWT del usuario. El √≠ndice de Elasticsearch contiene campos `visibility`, `owner_id` y `shared_with[]` sincronizados desde MongoDB v√≠a Change Streams. Los filtros booleanos de Elasticsearch son extremadamente eficientes (filtro en cached segments), garantizando **100% compliance** sin degradaci√≥n de performance, cumpliendo ESC-04.

---

## Escenario
| Atributo | ID Escenario | Fuente Est√≠mulo | Est√≠mulo | Artefacto | Entorno | Respuesta | Medida de Respuesta | Comentario |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| **Rendimiento** | **ESC-05** | M√∫ltiples usuarios simult√°neos | 500+ usuarios realizan b√∫squedas complejas concurrentemente | Servidor de b√∫squeda y base de datos | Pico de tr√°fico en horario prime | El sistema mantiene tiempos de respuesta aceptables mediante cach√© e indexaci√≥n | p95 ‚â§ 2 seg, p99 ‚â§ 3 seg | Asegura escalabilidad en momentos de alta demanda |

### T√°ctica Elegida
La t√°ctica elegida es **Mantener M√∫ltiples Copias**, espec√≠ficamente mediante replicaci√≥n activa de servicios y sharding de datos.

**T√≠tulo**:
- Implementaci√≥n de Escalamiento Horizontal con Replicaci√≥n y Sharding para Alta Concurrencia (ESC-05).

**Contexto**:
- NEXUS espera picos de tr√°fico durante eventos de marketing o lanzamientos importantes. El M√≥dulo 1 debe soportar 500+ usuarios realizando b√∫squedas complejas (m√∫ltiples filtros, ordenamiento) simult√°neamente, manteniendo p95 ‚â§ 2s y p99 ‚â§ 3s.

**Alternativas**:
1. **Mantener M√∫ltiples Copias (Replicaci√≥n + Sharding)**:
    - Desplegar m√∫ltiples instancias del microservicio de b√∫squeda con balanceador de carga (ALB). Configurar Elasticsearch con 3 shards primarios y 2 r√©plicas por shard distribuidas en 3 nodos.
    - Distribuye carga entre r√©plicas de servicio y paraleliza consultas entre shards de datos.
2. **Incrementar Recursos (Escalamiento Vertical)**:
    - Aumentar capacidad de servidor √∫nico con m√°s CPU/RAM.
    - L√≠mite f√≠sico de hardware, punto √∫nico de falla, mayor costo por unidad de capacidad.

**Criterios de Elecci√≥n**:
- Soportar 500+ usuarios concurrentes sin degradaci√≥n.
- Cumplir m√©tricas p95 ‚â§ 2s, p99 ‚â§ 3s bajo pico de carga.
- Elasticidad para crecer/decrecer seg√∫n demanda.

**Decisi√≥n**:
- Se elige la t√°ctica de **Mantener M√∫ltiples Copias** mediante auto-scaling horizontal del microservicio y arquitectura distribuida de Elasticsearch.

**Sustento**:
- Desplegando el microservicio en **Kubernetes con HPA** (Horizontal Pod Autoscaler) configurado para escalar de 2 a 10 r√©plicas basado en CPU > 70% y latencia p95, el sistema distribuye autom√°ticamente la carga. Elasticsearch con **3 shards primarios + 2 r√©plicas** distribuye consultas en paralelo entre 9 copias de datos (3√ó3). Un Application Load Balancer distribuye tr√°fico con round-robin entre r√©plicas de servicio. Esta arquitectura garantiza **p95 ‚â§ 2s** y **p99 ‚â§ 3s** durante picos de 500+ usuarios concurrentes, cumpliendo ESC-05.

---
[üè† Home](../../README.md) | [Siguiente ‚û°Ô∏è](../5.2/5.2.md)