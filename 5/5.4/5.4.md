> [5. T√°cticas](../5.md) ‚Ä∫ [5.4. M√≥dulo 4 / Integrante 4](5.4.md)

# 5.4. M√≥dulo 4 / Integrante 4

## Escenario
| Atributo | ID Escenario | Fuente Est√≠mulo | Est√≠mulo | Artefacto | Entorno | Respuesta | Medida de Respuesta | Comentario |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| **Disponibilidad** | **ESC-01** | Usuario con conexi√≥n intermitente | Usuario pierde conectividad o falla un servicio auxiliar al crear/publicar | M√≥dulo de Publicaci√≥n de Ideas | Uso normal con conexi√≥n inestable | El sistema autoguarda y recupera borrador al reconectarse, notificando al usuario | Recuperaci√≥n en ‚â§ 5 seg tras reconexi√≥n | Evita p√©rdida de trabajo, cr√≠tico para confianza del usuario |

### T√°ctica Elegida
La t√°ctica elegida es **Almacenamiento de Estado (Cache/Local)**, que permite a la interfaz de usuario guardar una copia del borrador localmente y sincronizarlo al reconectarse.

**T√≠tulo**:
- T√°ctica de Autoguardado Local para Garantizar la Recuperaci√≥n de Borradores (ESC-01).

**Contexto**:
- Los usuarios de NEXUS pueden tardar tiempo en redactar sus ideas (HU003), que son extensas y detalladas. El requisito funcional **RF009** exige un autoguardado cada 30 segundos. La p√©rdida de conectividad (ESC-01) o la falla del servidor auxiliar no debe resultar en la p√©rdida de trabajo, ya que esto impactar√≠a directamente la confianza del usuario.

**Alternativas**:
1. **Almacenamiento de Estado Local (Cache/IndexDB)**:
    - La aplicaci√≥n cliente (**React Native / Next.js**) guarda activamente los cambios en el almacenamiento persistente del dispositivo. Cuando la conexi√≥n se recupera, el cliente intenta sincronizar el borrador guardado localmente con el servidor.
    - Proporciona una recuperaci√≥n inmediata e independiente de la conectividad del servidor.
2. **Registro de Transacciones en Servidor Auxiliar**:
    - Usar un servicio de mensajer√≠a as√≠ncrona (ej. Kafka) para registrar cada peque√±a pulsaci√≥n de tecla y reconstruir el borrador en el servidor en caso de falla.
    - Requiere alta complejidad de infraestructura y consume m√°s recursos del servidor.

**Criterios de Elecci√≥n**:
- Velocidad de recuperaci√≥n para el usuario (‚â§ 5 seg).
- Simplicidad y costo de implementaci√≥n (favorecer el lado del cliente).
- Minimizar el riesgo de p√©rdida de datos ante intermitencia.

**Decisi√≥n**:
- Se elige la t√°ctica de **Almacenamiento de Estado Local (Local Cache)**, utilizando las capacidades de almacenamiento persistente del navegador o la plataforma m√≥vil.

**Sustento**:
- La **recuperaci√≥n de 5 segundos** es m√°s factible utilizando un estado ya presente en el dispositivo del usuario. Almacenar el borrador en el *Local Storage* de la aplicaci√≥n permite que la recuperaci√≥n sea inmediata al restablecerse la conectividad, simplemente cargando la versi√≥n local y presentando el aviso al usuario. Esto a√≠sla al usuario de la falla del servicio auxiliar o la intermitencia de la red, siendo la soluci√≥n m√°s simple y directa para el escenario ESC-01.

---

## Escenario
| Atributo | ID Escenario | Fuente Est√≠mulo | Est√≠mulo | Artefacto | Entorno | Respuesta | Medida de Respuesta | Comentario |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| **Rendimiento** | **ESC-02** | Carga masiva de usuarios | Pico masivo de tr√°fico con miles de usuarios concurrentes | Servidor principal del M√≥dulo de Publicaci√≥n de Ideas | Evento de alta concurrencia | El sistema escala horizontalmente manteniendo respuesta aceptable | Disponibilidad ‚â• 90% | Garantiza confiabilidad en momentos cr√≠ticos |

### T√°ctica Elegida
La t√°ctica elegida es **Replicaci√≥n de Componentes** (Escalamiento Horizontal), que permite distribuir la carga de las solicitudes de creaci√≥n y edici√≥n.

**T√≠tulo**:
- Uso de Replicaci√≥n Activa para Escalamiento Horizontal en el Microservicio de Ideas (ESC-02).

**Contexto**:
- NEXUS espera picos de tr√°fico ante eventos de marketing o grandes lanzamientos (ESC-02). El M√≥dulo 2 debe manejar miles de usuarios creando y editando ideas simult√°neamente. Como se defini√≥ en el ADR de Arquitectura, este es un microservicio.

**Alternativas**:
1. **Replicaci√≥n de Componentes (Activa/Pasiva)**:
    - Crear m√∫ltiples instancias id√©nticas del microservicio de Ideas y distribuir el tr√°fico entre ellas con un Balanceador de Carga. Todas las instancias activas pueden recibir peticiones.
    - Permite la **Escalabilidad Horizontal**, que es ideal para picos de tr√°fico inesperados.
2. **Asignaci√≥n de Recursos (Incremento Vertical)**:
    - Aumentar la capacidad de la √∫nica instancia del servidor (m√°s CPU, m√°s RAM).
    - Limitado por la capacidad m√°xima del servidor y requiere *downtime* para aplicar cambios.

**Criterios de Elecci√≥n**:
- Manejar picos masivos de tr√°fico sin degradaci√≥n del servicio.
- Cumplir con la medida de respuesta de **Disponibilidad ‚â• 90%** durante el pico.
- Compatibilidad con la arquitectura de microservicios.

**Decisi√≥n**:
- Se elige la t√°ctica de **Replicaci√≥n de Componentes** en modo activo, combinada con Balanceo de Carga L7 (*Application Load Balancer*).

**Sustento**:
- La **Replicaci√≥n de Componentes** (Escalamiento Horizontal) es la forma m√°s efectiva y sencilla de asegurar que el M√≥dulo de Ideas pueda absorber la carga masiva (ESC-02). El Balanceador de Carga distribuir√° las solicitudes entre las r√©plicas del servicio. Si una instancia falla, el *load balancer* la saca de la rotaci√≥n, manteniendo la disponibilidad requerida. Esto es un est√°ndar de la industria que se implementa f√°cilmente en plataformas *cloud* (como se mencion√≥ en la ADR de CDN).

---

## Escenario
| Atributo | ID Escenario | Fuente Est√≠mulo | Est√≠mulo | Artefacto | Entorno | Respuesta | Medida de Respuesta | Comentario |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| **Seguridad** | **ESC-06** | Atacante externo / bot | Atacante realiza fuerza bruta o spam de ideas | Servidor de procesamiento de ideas | Acceso externo no autorizado | El sistema bloquea, detecta y registra intentos | Bloqueo ‚â§ 2 seg, registro en bit√°cora | Protege datos y reputaci√≥n de la plataforma |

### T√°ctica Elegida
La t√°ctica elegida es **Limitar el Acceso**, espec√≠ficamente mediante la t√©cnica de *Rate Limiting* (Limitaci√≥n de Tasa).

**T√≠tulo**:
- Implementaci√≥n de Limitaci√≥n de Tasa (*Rate Limiting*) para mitigar Ataques de Fuerza Bruta y Spam (ESC-06).

**Contexto**:
- El endpoint de creaci√≥n de ideas (HU001) y el de inicio de sesi√≥n (M√≥dulo 1, pero relevante para ataques) son vulnerables al *spam* o ataques de fuerza bruta (ESC-06). Se requiere una respuesta r√°pida (bloqueo en ‚â§ 2 seg) para proteger la integridad del sistema y evitar la sobrecarga de recursos.

**Alternativas**:
1. **Limitar el Acceso (Rate Limiting)**:
    - Restringir la cantidad de solicitudes que una IP o un usuario autenticado puede realizar a un endpoint espec√≠fico (ej. `/api/v1/ideas/create`) dentro de un periodo de tiempo.
    - Es la forma m√°s r√°pida y sencilla de mitigar ataques de fuerza bruta y spam de ideas.
2. **Autorizaci√≥n y Autenticaci√≥n Robustas**:
    - Implementar doble factor de autenticaci√≥n o pol√≠ticas de contrase√±as complejas.
    - Necesario, pero no previene ataques de *bots* no autenticados o usuarios maliciosos que ya han iniciado sesi√≥n.

**Criterios de Elecci√≥n**:
- Rapidez de respuesta ante el ataque (‚â§ 2 seg).
- Eficiencia para proteger recursos de procesamiento.
- Simplicidad de implementaci√≥n a nivel de API Gateway o *Load Balancer*.

**Decisi√≥n**:
- Se elige la t√°ctica de **Limitar el Acceso (Rate Limiting)** en el *API Gateway* que antecede al microservicio de Ideas.

**Sustento**:
- La implementaci√≥n de *Rate Limiting* en la capa de infraestructura es la soluci√≥n m√°s r√°pida y eficiente para el escenario ESC-06. Permite detectar un patr√≥n de solicitudes excesivas (ej. m√°s de 5 creaciones de ideas por minuto por IP) y bloquearlas en un tiempo casi instant√°neo (‚â§ 2 seg), protegiendo la reputaci√≥n y la disponibilidad de los recursos del servidor de ideas. Esto se complementa con la **Bit√°cora** para el registro del evento.

---

## Escenario
| Atributo | ID Escenario | Fuente Est√≠mulo | Est√≠mulo | Artefacto | Entorno | Respuesta | Medida de Respuesta | Comentario |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| **Testabilidad** | **ESC-09** | Equipo QA | QA ejecuta pruebas automatizadas en flujos cr√≠ticos | Entorno de pruebas del M√≥dulo de Publicaci√≥n de Ideas | Ejecuci√≥n en ambiente de staging | Soporta datos simulados, logs completos y trazabilidad | Respuesta ‚â§ 2 seg por caso, 100% cobertura de logs | Detecta defectos temprano y asegura calidad continua |

### T√°ctica Elegida
La t√°ctica elegida es **Separar Preocupaciones** (Separar *Concerns*), aplicando un dise√±o modular o por capas.

**T√≠tulo**:
- Adopci√≥n del Patr√≥n *Model-View-Controller* (MVC) para maximizar la Testabilidad (ESC-09).

**Contexto**:
- Para que el equipo de QA pueda ejecutar pruebas automatizadas de forma r√°pida y confiable (Respuesta ‚â§ 2 seg por caso), la l√≥gica de negocio debe ser probada de forma aislada de las dependencias (ej. base de datos, API externas). Esto requiere una estructura interna del microservicio que facilite la simulaci√≥n (*mocking*) de dependencias.

**Alternativas**:
1. **Separar Preocupaciones (Modelo por Capas / MVC)**:
    - Dividir el c√≥digo del microservicio en capas l√≥gicas (Controladores, Servicios/L√≥gica de Negocio, Repositorios/Acceso a Datos).
    - Permite probar la **L√≥gica de Negocio** de forma aislada al simular la capa de acceso a datos o las dependencias externas (API).
2. **Generaci√≥n de Entorno de Prueba Dedicado**:
    - Crear una copia completa del ambiente de producci√≥n para cada prueba.
    - Alto costo y lentitud, no apto para pruebas unitarias ni para cumplir con el tiempo de respuesta r√°pido (‚â§ 2 seg).

**Criterios de Elecci√≥n**:
- Aislamiento de la l√≥gica para pruebas unitarias r√°pidas.
- Facilidad para crear datos simulados (*mocks*).
- Compatibilidad con la arquitectura de microservicios elegida.

**Decisi√≥n**:
- Se elige la t√°ctica de **Separar Preocupaciones** mediante la implementaci√≥n del patr√≥n **MVC** (o Patr√≥n de Repositorio/Servicio) dentro del microservicio de Ideas.

**Sustento**:
- Al dividir el microservicio, la **l√≥gica de validaci√≥n de campos** (RF002) y la **gesti√≥n de estados** (RF010) residen en la capa de servicios, separada del controlador HTTP (View/API) y del repositorio de datos (Model). Esto permite al equipo de QA probar los flujos cr√≠ticos con *mocks* de datos, logrando una **respuesta r√°pida (‚â§ 2 seg)** por caso de prueba y facilitando la cobertura de *logs* y la trazabilidad, satisfaciendo el escenario ESC-09.

---

## Escenario
| Atributo | ID Escenario | Fuente Est√≠mulo | Est√≠mulo | Artefacto | Entorno | Respuesta | Medida de Respuesta | Comentario |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| **Mantenibilidad** | **ESC-10** | Equipo de desarrollo | Se requiere agregar un nuevo componente funcional | M√≥dulo de Publicaci√≥n de Ideas | Ciclo de evoluci√≥n del sistema | Integraci√≥n de nuevo m√≥dulo con bajo impacto | Integraci√≥n ‚â§ 3 d√≠as, < 5% refactorizaci√≥n existente | Facilita evoluci√≥n y sostenibilidad |

### T√°ctica Elegida
La t√°ctica elegida es **Separar Interfaz de Implementaci√≥n (Abstracci√≥n)**, usando Interfaces o Contratos.

**T√≠tulo**:
- Uso de Abstracci√≥n de Contratos (Interfaces) para garantizar la Modificabilidad (ESC-10).

**Contexto**:
- NEXUS est√° en constante evoluci√≥n. Se prev√© la necesidad de agregar nuevas funcionalidades (ej. un m√≥dulo de "Recomendaci√≥n de Ideas" que consulte las publicaciones existentes). El requisito (ESC-10) es que la integraci√≥n de nuevos componentes sea r√°pida (‚â§ 3 d√≠as) y que la refactorizaci√≥n del c√≥digo existente del M√≥dulo 2 sea m√≠nima (< 5%).

**Alternativas**:
1. **Separar Interfaz de Implementaci√≥n (Abstracci√≥n)**:
    - Definir **Interfaces o Contratos de Servicio** claros y estables (*Design by Contract*). Los nuevos m√≥dulos (el que consume) solo interact√∫an con el contrato, no con la implementaci√≥n interna del servicio de Ideas (el que provee).
    - Si se cambia la base de datos interna de Ideas (ADR 4), la interfaz no necesita cambiar.
2. **Limitar las Opciones (Estandarizaci√≥n)**:
    - Estandarizar tecnolog√≠as y *frameworks*.
    - Si bien ayuda a la mantenibilidad del equipo, no asegura que la l√≥gica de negocio existente no se rompa al integrar un nuevo componente.

**Criterios de Elecci√≥n**:
- Reducir el acoplamiento entre el M√≥dulo de Ideas y los futuros m√≥dulos que lo consumen.
- Minimizar el impacto (refactorizaci√≥n < 5%) en el c√≥digo existente al evolucionar.
- Facilitar la integraci√≥n r√°pida de nuevas funcionalidades.

**Decisi√≥n**:
- Se elige la t√°ctica de **Separar Interfaz de Implementaci√≥n (Abstracci√≥n)**, obligando a que la comunicaci√≥n del microservicio de Ideas se realice a trav√©s de un contrato API bien documentado.

**Sustento**:
- Al tener una interfaz p√∫blica estable (el *contrato* de la API REST o gRPC), el equipo puede desarrollar nuevos componentes funcionales (M√≥dulo de Recomendaci√≥n, por ejemplo) bas√°ndose √∫nicamente en dicho contrato. Si el equipo del M√≥dulo 2 necesita refactorizar internamente su c√≥digo o cambiar el modelo NoSQL (Decisi√≥n 4), esto no afecta a los consumidores, lo que garantiza el requisito de **< 5% de refactorizaci√≥n** y permite una **integraci√≥n r√°pida (‚â§ 3 d√≠as)**.


---

[‚¨ÖÔ∏è Anterior](../5.3/5.3.md) | [üè† Home](../../README.md) | [Siguiente ‚û°Ô∏è](../5.5/5.5.md)